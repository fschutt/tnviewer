<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Tats√§chliche Nutzung Viewer / Editor</title>
    <link rel="stylesheet" href="./js/leaflet/leaflet.css">
    <script src="./js/leaflet/leaflet.js"></script>
    <link rel="stylesheet" href="main.css">
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
    <script type="module" src="./js/custom/ui.js"></script>
    <script type="module">
      import init, {ui_render_entire_screen} from "./pkg/tnviewer.js";

      var map = null;

      init()
        .then(() => { 
          var uidata = {
            popover_state: null,
            tab: null, 
            data_loaded: false,
          };
          var array = new Uint8Array();
          document.body.innerHTML = ui_render_entire_screen(array);

          function initializeOrUpdateMap() {
            var id = document.getElementById("mapboxtoken");
            if (!id) {
              return;
            }
            if (id.value.length == 0) {
              return;
            }
            var mapcontainer = document.getElementById("map");
            if (!mapcontainer) {
              return;
            }
            if (map == null) {
              map = L.map('map').setView([51.505, -0.09], 13);

              L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
                  attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
              }).addTo(map);
            }
          }

          map = L.map('map').setView([53.2467, 13.6045], 10);

          L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
              attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
          }).addTo(map);

          // setInterval(initializeOrUpdateMap, 100);
        });       
    </script>
  </head>
  <body>
  </body>
</html>
