<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Tats√§chliche Nutzung Viewer / Editor</title>
    <link rel="stylesheet" href="main.css">
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
    <link href="https://api.mapbox.com/mapbox-gl-js/v3.4.0/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v3.4.0/mapbox-gl.js"></script>
    <script type="module">
      import init, {ui_render_entire_screen} from "./pkg/tnviewer.js";

      init()
        .then(() => { 
          var uidata = {
            popover_state: null,
            tab: null, 
            data_loaded: false,
          };
          var array = new Uint8Array();
          document.body.innerHTML = ui_render_entire_screen(array);

          function initializeOrUpdateMap() {
            var id = document.getElementById("mapboxtoken");
            if (!id) {
              return;
            }
            if (id.value.length == 0) {
              return;
            }
            var mapcontainer = document.getElementById("map");
            if (!mapcontainer) {
              return;
            }
            if (mapcontainer.innerHTML.length == 0) {
              mapboxgl.accessToken = id.value;
              var map = new mapboxgl.Map({
                  container: 'map',
                  center: [-74.5, 40],
                  zoom: 9
              });
            }
          }

          setInterval(initializeOrUpdateMap, 100);
        });       
    </script>
  </head>
  <body>
  </body>
</html>
