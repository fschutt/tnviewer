<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Tats√§chliche Nutzung Viewer / Editor</title>
    <link rel="stylesheet" href="main.css">
    <script type="module">
      import init, {ui_render_entire_screen} from "./pkg/tnviewer_bg.js";

      const downloadURL = (data, fileName) => {
        const a = document.createElement('a')
        a.href = data
        a.download = fileName
        document.body.appendChild(a)
        a.style.display = 'none'
        a.click()
        a.remove()
      }

      const downloadBlob = (data, fileName, mimeType) => {

        const blob = new Blob([data], {
            type: mimeType
        })

        const url = window.URL.createObjectURL(blob)

        downloadURL(url, fileName)

        setTimeout(() => window.URL.revokeObjectURL(url), 1000)
      }

      init()
        .then(() => { 
        
          var uidata = {
            popover_state: null,
            tab: null, 
            data_loaded: false,
          };
          var array = new Uint8Array();
          document.body.innerHTML = ui_render_entire_screen(array);

          /*
          document.querySelector('input').addEventListener('change', function() {

                var reader = new FileReader();
                reader.onload = function() {
                    var arrayBuffer = this.result;
                    var array = new Uint8Array(arrayBuffer);
                    var xlsx = xml_to_xlsx(array, document.getElementById("opt1").checked);
                    downloadBlob(xlsx, "Konvertiert.xlsx", 'application/octet-stream');
                }
                
                reader.readAsArrayBuffer(this.files[0]);

            }, false);
            */
        });       
    </script>
  </head>
  <body>
  </body>
</html>
